# ğŸ‘¨â€ğŸ’» å¼€å‘è€…äº¤æ¥æ–‡æ¡£ (Developer Handover)

æœ¬æ–‡æ¡£ä¸“ä¸º **åç»­æ¥æ‰‹çš„å¼€å‘è€…æˆ– AI åŠ©æ‰‹** è®¾è®¡ã€‚å®ƒä¸å…³æ³¨"æ€ä¹ˆç”¨"ï¼Œè€Œæ˜¯èšç„¦"**æ€ä¹ˆå†™**"å’Œ"**ç›®å‰çŠ¶æ€**"ã€‚

## ğŸ—ï¸ 1. ç³»ç»Ÿæ¶æ„ä¸æ ¸å¿ƒé€»è¾‘

### æ•´ä½“æ¶æ„ (MVC Pattern)
ç³»ç»Ÿä¸¥æ ¼éµå¾ª **Data - Analysis - UI** åˆ†å±‚æ¶æ„ï¼š

```mermaid
graph TD
    User[ç”¨æˆ·] --> UI[Streamlit UI å±‚]
    UI --> Analysis[åˆ†æå±‚ (Analyzer)]
    Analysis --> Data[æ•°æ®å±‚ (Provider)]
    Data --> APIs[å¤–éƒ¨æ¥å£ (AkShare/Tushare)]
    
    subgraph UIå±‚
    UnifiedApp --> Dashboard
    UnifiedApp --> AnalysisPage
    AnalysisPage --> Charts[Plotlyå›¾è¡¨]
    end
    
    subgraph åˆ†æå±‚
    FlowAnalyzer[èµ„é‡‘æµå‘]
    IndicatorCalculator[æŠ€æœ¯æŒ‡æ ‡]
    AnomalyDetector[å¼‚åŠ¨æ£€æµ‹]
    end
    
    subgraph æ•°æ®å±‚
    DataProvider[ç»Ÿä¸€æ¥å£]
    CacheManager[ç¼“å­˜ç®¡ç†]
    DataCleaner[æ¸…æ´—ä¸ä¿®å¤]
    end
```

### æ ¸å¿ƒæ•°æ®æµ (Data Flow)
1.  **Request**: ç”¨æˆ·åœ¨ `AnalysisPage` è¾“å…¥ä»£ç  + æ—¥æœŸã€‚
2.  **Fetch**: `AkShareProvider.get_tick_data()` è·å–åŸå§‹åˆ†é’ŸKçº¿ã€‚
3.  **Clean**: `DataCleaner` ä¿®å¤ç¼ºå¤±å€¼ã€è½¬æ¢ç±»å‹ (str -> float)ã€‚
4.  **Analyze**:
    *   `FlowAnalyzer`: åˆ†ç±»ä¸»åŠ›/æ•£æˆ·ï¼Œè®¡ç®—å‡€æµå…¥ã€‚
    *   `TimeSeriesAnalyzer`: è®¡ç®— VWAP, MA, RSIã€‚
5.  **Visualize**: `ChartGenerator` æ¥æ”¶æ¸…æ´—åçš„ DataFrameï¼Œç”Ÿæˆ Plotly Figureã€‚
6.  **Render**: Streamlit `st.plotly_chart()` æ¸²æŸ“åˆ°å‰ç«¯ã€‚

### ğŸ“‚ é¡¹ç›®ç›®å½•ç»“æ„ (Project Structure)
ä»¥ä¸‹æ˜¯é¡¹ç›®çš„æ ‡å‡†ç›®å½•ç»“æ„ï¼Œéæ­¤ç»“æ„çš„æ–‡ä»¶é€šå¸¸ä¸ºä¸´æ—¶è„šæœ¬ï¼š

```
stock_analysis/
â”œâ”€â”€ analysis/           # æ ¸å¿ƒä¸šåŠ¡é€»è¾‘
â”‚   â”œâ”€â”€ flows.py        # èµ„é‡‘æµå‘ç®—æ³•
â”‚   â”œâ”€â”€ market_hotspot.py # å¸‚åœºçƒ­ç‚¹/é¾™è™æ¦œ
â”‚   â””â”€â”€ ...
â”œâ”€â”€ core/               # åŸºç¡€è®¾æ–½
â”‚   â”œâ”€â”€ config.py       # å…¨å±€é…ç½®
â”‚   â”œâ”€â”€ cache_manager.py # ç¼“å­˜ç®¡ç†
â”‚   â””â”€â”€ help_text.py    # æ–‡æ¡ˆç®¡ç†
â”œâ”€â”€ data/               # æ•°æ®å±‚
â”‚   â”œâ”€â”€ providers/      # AkShare/Tushare æ¥å£
â”‚   â””â”€â”€ cleaner.py      # æ•°æ®æ¸…æ´—
â”œâ”€â”€ ui/                 # ç•Œé¢å±‚
â”‚   â”œâ”€â”€ unified_app.py  # ä¸»å…¥å£
â”‚   â”œâ”€â”€ analysis_page.py # ä¸ªè‚¡åˆ†æé¡µ
â”‚   â”œâ”€â”€ comparison_page.py # å¯¹æ¯”åˆ†æé¡µ
â”‚   â””â”€â”€ ...
â””â”€â”€ visualization/      # ç»˜å›¾å±‚
    â””â”€â”€ charts.py       # Plotly å›¾è¡¨ç”Ÿæˆ
```

---

## ğŸ“‚ 2. å…³é”®æ–‡ä»¶ç´¢å¼• (Key Files)

æ¥æ‰‹å¼€å‘å‰ï¼Œè¯·åŠ¡å¿…ç†Ÿæ‚‰ä»¥ä¸‹æ ¸å¿ƒæ–‡ä»¶ï¼š

| æ¨¡å— | æ–‡ä»¶è·¯å¾„ | èŒè´£è¯´æ˜ | ä¿®æ”¹é¢‘ç‡ |
| :--- | :--- | :--- | :--- |
| **å…¥å£** | `stock_analysis/ui/unified_app.py` | ç¨‹åºä¸»å…¥å£ï¼Œè´Ÿè´£å¯¼èˆªè·¯ç”± (æ›¿ä»£æ—§çš„ `app.py`) | â­ï¸â­ï¸ |
| **é¡µé¢** | `stock_analysis/ui/analysis_page.py` | æ ¸å¿ƒä¸ªè‚¡åˆ†æé¡µï¼ŒUI é€»è¾‘æœ€å¤æ‚ | â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸ |
| **æ•°æ®** | `stock_analysis/data/providers/akshare_provider.py` | AkShare æ¥å£å°è£…ï¼Œæœ€åº•å±‚æ•°æ®æº | â­ï¸â­ï¸â­ï¸ |
| **åˆ†æ** | `stock_analysis/analysis/flows.py` | **èµ„é‡‘æµç®—æ³•æ ¸å¿ƒ** (ä¸»åŠ›/æ•£æˆ·åˆ’åˆ†é€»è¾‘) | â­ï¸â­ï¸â­ï¸â­ï¸ |
| **å›¾è¡¨** | `stock_analysis/visualization/charts.py` | æ‰€æœ‰ Plotly å›¾è¡¨ç”Ÿæˆé€»è¾‘ (çƒ­åŠ›å›¾/æ›²çº¿) | â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸ |
| **é…ç½®** | `stock_analysis/core/config.py` | å…¨å±€é…ç½® (è·¯å¾„ã€é˜ˆå€¼ã€é¢œè‰²) | â­ï¸ |

---

## ğŸš¦ 3. é¡¹ç›®å½“å‰çŠ¶æ€ (Status Snapshot)

### âœ… å·²ç¨³å›ºçš„åŠŸèƒ½ (Stable)
*   [x] **åŒæ•°æ®æºå¼•æ“** (AkShare + Tushare) - é²æ£’æ€§å¼º
*   [x] **èµ„é‡‘æµå‘å›¾è¡¨** (ç´¯è®¡æµã€çƒ­åŠ›å›¾ã€å †å å›¾) - ç®—æ³•å·²å®šå‹
*   [x] **å¸‚åœºçƒ­ç‚¹æ¨¡å—** (æ¿å—ã€é¾™è™æ¦œ) - ç‹¬ç«‹è¿è¡Œè‰¯å¥½
*   [x] **éƒ¨ç½²æµç¨‹** (æœ¬åœ°/äº‘ç«¯) - æ–‡æ¡£å®Œå¤‡

### ğŸš§ æ­£åœ¨è¿›è¡Œä¸­ (WIP)
*   [ ] **å¤šè‚¡å¯¹æ¯”é¡µ** (`comparison_page.py`): UI å·²åŸºæœ¬å®Œæˆï¼Œä½†èµ„é‡‘æµè®¡ç®—é€»è¾‘ç›®å‰æ˜¯ç®€åŒ–çš„ï¼Œéœ€é‡æ„ä»¥å¤ç”¨ `FlowAnalyzer`ã€‚
*   [ ] **å›¾è¡¨äº¤äº’**: çƒ­åŠ›å›¾å°šæœªå®ç°ç‚¹å‡»è”åŠ¨è·³è½¬ï¼ˆéœ€ Streamlit Component æ”¯æŒï¼‰ã€‚

### âš ï¸ å·²çŸ¥æŠ€æœ¯å€º (Technical Debt)
1.  **ä¸»åŠ›åˆ’åˆ†ç²¾åº¦**: ç›®å‰ä¾èµ–åˆ†é’Ÿçº§æˆäº¤é‡ä¼°ç®— (1.5å€å‡é‡)ã€‚**å¿…é¡»**æ¥å…¥ Tick æ•°æ®æ‰èƒ½å®ç°ç²¾å‡†çš„ 20ä¸‡/ç¬” åˆ’åˆ†ã€‚
2.  **æ ·å¼è€¦åˆ**: éƒ¨åˆ† CSS æ ·å¼ç›´æ¥å†™åœ¨ `dashboard.py` ä¸­ï¼Œåº”æå–åˆ° `styling.py`ã€‚
3.  **å¼‚å¸¸å¤„ç†**: AkShare æ¥å£å¶å‘è¶…æ—¶ï¼Œç›®å‰çš„é‡è¯•æœºåˆ¶è¾ƒç®€å•ï¼Œéœ€å¢å¼ºã€‚

---

## ğŸ—ºï¸ 4. æ¥æ‰‹ä»»åŠ¡å»ºè®® (Next Steps)

å¦‚æœæ‚¨æ˜¯æ–°æ¥æ‰‹çš„ AI æˆ–å¼€å‘è€…ï¼Œå»ºè®®æŒ‰ä»¥ä¸‹é¡ºåºå¼€å±•å·¥ä½œï¼š

1.  **é˜…è¯» `USER_MANUAL.md` ä¸­çš„å›¾è¡¨ç®—æ³•ç« èŠ‚**ï¼šç†è§£ä¸šåŠ¡é€»è¾‘ã€‚
2.  **å®Œæˆ P1 (å¤šè‚¡å¯¹æ¯”)**ï¼š
    *   åœ¨ `charts.py` ä¸­æ–°å¢ `create_comparison_chart()`ã€‚
    *   å®Œå–„ `comparison_page.py` çš„æ•°æ®å¤„ç†é€»è¾‘ã€‚
3.  **æ”»å…‹ P2 (Tick æ•°æ®)**ï¼š
    *   ç ”ç©¶ `tushare.pro_tick` æ¥å£ã€‚
    *   é‡å†™ `FlowAnalyzer` ä»¥æ”¯æŒ Tick çº§é€ç¬”è®¡ç®—ã€‚

---

> **ç»™ AI çš„æç¤º (Prompt Tip)**:
> å½“ä½ éœ€è¦ä¿®æ”¹å›¾è¡¨æ—¶ï¼Œè¯·ä¼˜å…ˆè¯»å– `charts.py` å’Œ `analysis_page.py`ã€‚
> å½“ä½ éœ€è¦ä¿®æ”¹æ•°æ®æºæ—¶ï¼Œè¯·åŠ¡å¿…æ£€æŸ¥ `akshare_provider.py` å’Œ `tushare_provider.py` çš„å·®å¼‚ã€‚
