<!DOCTYPE html>
<!--
  é›†æˆä»£ç ç‰‡æ®µ - ç”¨äºä¸»ç½‘é¡µï¼ˆstock-monitor-2025.web.appï¼‰
  
  ä½¿ç”¨æ–¹æ³•ï¼š
  1. å°†æ­¤ä»£ç æ·»åŠ åˆ°ä¸»ç½‘é¡µçš„ HTML ä¸­
  2. æ›¿æ¢ STREAMLIT_APP_URL ä¸ºå®é™…éƒ¨ç½²çš„ URL
  3. è°ƒæ•´æ ·å¼ä»¥åŒ¹é…ä¸»ç½‘é¡µé£æ ¼
-->

<!-- ===== 1. åœ¨å¯¼èˆªæ æ·»åŠ æ–° Tab ===== -->
<!-- æ‰¾åˆ°ç°æœ‰çš„ tab æŒ‰é’®åŒºåŸŸï¼Œæ·»åŠ ï¼š -->

<button class="tab-button" onclick="showTab('analysis')" id="analysis-tab-btn">
  ğŸ“ˆ èµ„é‡‘åˆ†æ
</button>

<!-- ===== 2. æ·»åŠ  Tab å†…å®¹åŒºåŸŸ ===== -->
<!-- åœ¨å…¶ä»– tab-content åé¢æ·»åŠ ï¼š -->

<div id="analysis-tab" class="tab-content" style="display: none;">
  <div class="analysis-container">
    <div class="analysis-header">
      <h2>ğŸ“ˆ å®æ—¶èµ„é‡‘æµå‘åˆ†æ</h2>
      <p class="subtitle">åŸºäºåˆ†é’Ÿçº§æ•°æ®çš„å¤šç»´åº¦æŠ€æœ¯åˆ†æ</p>
    </div>
    
    <!-- Loading çŠ¶æ€ -->
    <div id="analysis-loading" class="loading-indicator">
      <div class="spinner"></div>
      <p>æ­£åœ¨åŠ è½½åˆ†æç³»ç»Ÿ...</p>
    </div>
    
    <!-- Streamlit åº”ç”¨ iframe -->
    <iframe 
      id="analysis-iframe"
      src="https://YOUR_APP_NAME.streamlit.app"
      width="100%"
      height="0"
      frameborder="0"
      allow="clipboard-write"
      onload="handleIframeLoad()"
      style="display: none; border-radius: 8px; box-shadow: 0 2px 12px rgba(0,0,0,0.1);">
    </iframe>
    
    <div class="analysis-footer">
      <p class="disclaimer">
        âš ï¸ æ•°æ®åˆ†æä»…ä¾›å‚è€ƒï¼Œä¸æ„æˆæŠ•èµ„å»ºè®®
      </p>
    </div>
  </div>
</div>

<!-- ===== 3. æ·»åŠ æ ·å¼ ===== -->
<style>
.analysis-container {
  max-width: 1400px;
  margin: 0 auto;
  padding: 20px;
}

.analysis-header {
  text-align: center;
  margin-bottom: 20px;
}

.analysis-header h2 {
  color: #1890ff;
  font-size: 28px;
  margin-bottom: 8px;
}

.analysis-header .subtitle {
  color: #666;
  font-size: 14px;
}

/* Loading åŠ¨ç”» */
.loading-indicator {
  text-align: center;
  padding: 80px 20px;
}

.spinner {
  border: 4px solid #f3f3f3;
  border-top: 4px solid #1890ff;
  border-radius: 50%;
  width: 50px;
  height: 50px;
  animation: spin 1s linear infinite;
  margin: 0 auto 20px;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

/* iframe æ ·å¼ */
#analysis-iframe {
  transition: opacity 0.3s ease-in-out;
  min-height: 900px;
}

#analysis-iframe.loaded {
  opacity: 1;
}

.analysis-footer {
  text-align: center;
  margin-top: 20px;
  padding: 15px;
  background: #fff9e6;
  border-radius: 4px;
}

.analysis-footer .disclaimer {
  color: #d48806;
  font-size: 13px;
  margin: 0;
}

/* å“åº”å¼ */
@media (max-width: 768px) {
  .analysis-container {
    padding: 10px;
  }
  
  .analysis-header h2 {
    font-size: 22px;
  }
  
  #analysis-iframe {
    min-height: calc(100vh - 180px);
  }
}
</style>

<!-- ===== 4. æ·»åŠ  JavaScript ===== -->
<script>
// Tab åˆ‡æ¢å‡½æ•°ï¼ˆå¦‚æœä¸»ç½‘é¡µå·²æœ‰ï¼Œå¯ä»¥åˆå¹¶ï¼‰
function showTab(tabName) {
  // éšè—æ‰€æœ‰ tab content
  const allTabs = document.querySelectorAll('.tab-content');
  allTabs.forEach(tab => {
    tab.style.display = 'none';
  });
  
  // ç§»é™¤æ‰€æœ‰ tab button çš„ active çŠ¶æ€
  const allButtons = document.querySelectorAll('.tab-button');
  allButtons.forEach(btn => {
    btn.classList.remove('active');
  });
  
  // æ˜¾ç¤ºé€‰ä¸­çš„ tab
  const selectedTab = document.getElementById(tabName + '-tab');
  if (selectedTab) {
    selectedTab.style.display = 'block';
  }
  
  // æ¿€æ´»æŒ‰é’®
  const selectedBtn = document.getElementById(tabName + '-tab-btn');
  if (selectedBtn) {
    selectedBtn.classList.add('active');
  }
  
  // å¦‚æœæ˜¯åˆ†æ tabï¼Œè°ƒæ•´ iframe é«˜åº¦
  if (tabName === 'analysis') {
    adjustIframeHeight();
  }
}

// iframe åŠ è½½å®Œæˆå¤„ç†
function handleIframeLoad() {
  const iframe = document.getElementById('analysis-iframe');
  const loading = document.getElementById('analysis-loading');
  
  // éšè— loading
  if (loading) {
    loading.style.display = 'none';
  }
  
  // æ˜¾ç¤º iframe
  if (iframe) {
    iframe.style.display = 'block';
    iframe.style.height = '900px';
    iframe.classList.add('loaded');
  }
}

// è°ƒæ•´ iframe é«˜åº¦ï¼ˆå“åº”å¼ï¼‰
function adjustIframeHeight() {
  const iframe = document.getElementById('analysis-iframe');
  if (iframe && window.innerWidth <= 768) {
    iframe.style.height = (window.innerHeight - 180) + 'px';
  } else if (iframe) {
    iframe.style.height = '900px';
  }
}

// ç›‘å¬çª—å£å¤§å°å˜åŒ–
window.addEventListener('resize', adjustIframeHeight);

// é¡µé¢åŠ è½½æ—¶çš„åˆå§‹åŒ–
document.addEventListener('DOMContentLoaded', function() {
  // å¯ä»¥è®¾ç½®é»˜è®¤ tab
  // showTab('profit'); // æˆ–å…¶ä»–é»˜è®¤ tab
});
</script>

<!-- ===== ä½¿ç”¨è¯´æ˜ ===== -->
<!--
1. å¤åˆ¶ä¸Šé¢çš„ä»£ç 
2. æ ¹æ®ä¸»ç½‘é¡µç°æœ‰ç»“æ„è°ƒæ•´ï¼š
   - tab-button å’Œ tab-content çš„ class åç§°
   - é¢œè‰²ä¸»é¢˜ï¼ˆ#1890ff æ”¹ä¸ºä¸»ç½‘é¡µä¸»è‰²è°ƒï¼‰
   - å­—ä½“å’Œé—´è·
3. æ›¿æ¢ iframe src ä¸ºå®é™…çš„ Streamlit åº”ç”¨ URL
4. æµ‹è¯•å“åº”å¼æ•ˆæœ
5. éƒ¨ç½²ï¼

æç¤ºï¼š
- å¦‚æœä¸»ç½‘é¡µå·²æœ‰ tab åˆ‡æ¢é€»è¾‘ï¼Œæ•´åˆåˆ°ç°æœ‰å‡½æ•°ä¸­
- å¯ä»¥æ·»åŠ æ›´å¤šäº¤äº’ï¼Œå¦‚ä»æŒä»“åˆ—è¡¨ä¼ å‚ç»™åˆ†ææ¨¡å—
- å»ºè®®åœ¨æœ¬åœ°æµ‹è¯•åå†éƒ¨ç½²åˆ° Firebase
-->
